unit uFrmRelProdutos;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Data.DB, ppParameter, ppDesignLayer,
  ppBands, ppCtrls, ppVar, ppPrnabl, ppClass, ppCache, ppProd, ppReport, ppDB,
  ppComm, ppRelatv, ppDBPipe, Datasnap.Provider, Datasnap.DBClient, Vcl.Grids,
  Vcl.DBGrids, Vcl.StdCtrls, Vcl.Buttons;

type
  TFrmRelProdutos = class(TForm)
    btnFechar: TBitBtn;
    DBGridDados: TDBGrid;
    btnImprimir: TBitBtn;
    btnImprimeTodos: TBitBtn;
    cdsProdutoSel: TClientDataSet;
    cdsProdutoSelCODIGO: TIntegerField;
    cdsProdutoSelRAZAO: TStringField;
    cdsProdutoSelINSCRICAO: TStringField;
    dsProdutoSel: TDataSource;
    dspProdutos: TDataSetProvider;
    cdsProduto: TClientDataSet;
    cdsProdutoCODIGO: TIntegerField;
    dsProduto: TDataSource;
    ppDBPipeline1: TppDBPipeline;
    ppDBPipeline1ppField1: TppField;
    ppDBPipeline1ppField2: TppField;
    ppDBPipeline1ppField3: TppField;
    ppReportProdutos: TppReport;
    ppHeaderBand1: TppHeaderBand;
    ppLabel11: TppLabel;
    ppLabel13: TppLabel;
    ppLabel14: TppLabel;
    ppSystemVariable1: TppSystemVariable;
    ppLabel1: TppLabel;
    ppLabel2: TppLabel;
    ppLabel3: TppLabel;
    ppLine1: TppLine;
    ppDetailBand1: TppDetailBand;
    ppDBText1: TppDBText;
    ppDBText2: TppDBText;
    ppDBText3: TppDBText;
    ppFooterBand1: TppFooterBand;
    ppDesignLayers1: TppDesignLayers;
    ppDesignLayer1: TppDesignLayer;
    ppParameterList1: TppParameterList;
    cdsProdutoDESCRICAO: TStringField;
    procedure FormShow(Sender: TObject);
    procedure btnImprimeTodosClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FrmRelProdutos: TFrmRelProdutos;

implementation

{$R *.dfm}

procedure TFrmRelProdutos.FormShow(Sender: TObject);
begin
  cdsProduto.Close;
  cdsProduto.CommandText := 'SELECT CODIGO, DESCRICAO '+
                            'FROM PRODUTOS            ';
  cdsProduto.Open;
end;

procedure TFrmRelProdutos.btnImprimeTodosClick(Sender: TObject);
begin
  cdsProdutoSel.Close;
  cdsProdutoSel.CommandText := 'SELECT CODIGO, RAZAO, INSCRICAO '+
                               'FROM CLIENTES                   ';
  cdsProdutoSel.Open;
  ppReportCliente.Print;

end;

end.
