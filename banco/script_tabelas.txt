USE [BASE]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

-- TABELA DE PRODUTOS
CREATE TABLE PRODUTOS(
	CODIGO int IDENTITY(1,1) NOT NULL,
	DESCRICAO varchar(50) NOT NULL,
 CONSTRAINT [PK_PRODUTOS] PRIMARY KEY CLUSTERED 
(
	CODIGO ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO


-- TABELA DE CLIENTES
CREATE TABLE CLIENTES(
	CODIGO int IDENTITY(1,1) NOT NULL,
	RAZAO varchar(100) NOT NULL,
	INSCRICAO varchar(30) NULL,
 CONSTRAINT [PK_CLIENTES] PRIMARY KEY CLUSTERED 
(
	[CODIGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

-- TABELA DE PEDIDOS
CREATE TABLE PEDIDO(
	CODIGO int IDENTITY(1,1) NOT NULL,
	REFERENCIA int NULL,
	NUM_Pedido int NOT NULL,
	Data_Emissao smalldatetime NULL,
	COD_Cliente int NOT NULL,
	TIP_OPERACAO varchar(10) NULL,
	TOT_Pedido numeric(18, 4) NULL,
 CONSTRAINT [PK_PEDIDO] PRIMARY KEY CLUSTERED 
(
	CODIGO ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [PEDIDO]  WITH NOCHECK ADD  CONSTRAINT [FK_PED_CLIENTE] FOREIGN KEY([COD_Cliente])
REFERENCES [CLIENTES] ([CODIGO])
NOT FOR REPLICATION 
GO

ALTER TABLE [PEDIDO] CHECK CONSTRAINT [FK_PED_CLIENTE]
GO


-- TABELA DE ITENS DOS PEDIDOS
CREATE TABLE ITEMPED(
	CODIGO int IDENTITY(1,1) NOT NULL,
	COD_PEDIDO int NOT NULL,
	COD_PRODUTO int NOT NULL,
	QTD int NOT NULL,
	VR_UNIT numeric(18, 4) NULL,
	TOT_ITEM numeric(18, 4) NULL,
 CONSTRAINT [PK_ITEM] PRIMARY KEY CLUSTERED 
(
	CODIGO ASC,
	COD_PEDIDO ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [ITEMPED]  WITH NOCHECK ADD  CONSTRAINT [FK_PED_ITEM] FOREIGN KEY([COD_PEDIDO])
REFERENCES [PEDIDO] ([CODIGO])
NOT FOR REPLICATION 
GO

ALTER TABLE [ITEMPED] CHECK CONSTRAINT [FK_PED_ITEM]
GO

ALTER TABLE [ITEMPED]  WITH NOCHECK ADD  CONSTRAINT [FK_PRO_ITEM] FOREIGN KEY([COD_PRODUTO])
REFERENCES [PRODUTOS] ([CODIGO])
NOT FOR REPLICATION 
GO

ALTER TABLE [ITEMPED] CHECK CONSTRAINT [FK_PRO_ITEM]
GO

-- TABELA DE FORMA DE PAGAMENTO DO PEDIDO
CREATE TABLE PARPED(
	CODIGO int IDENTITY(1,1) NOT NULL,
	COD_PEDIDO int NOT NULL,
	FORMA_PAG int NULL,
	DAT_VENCIMENTO smalldatetime NULL,
	VAL_PARCELA numeric (18, 4) NULL,
 CONSTRAINT [PK_PARCELA] PRIMARY KEY CLUSTERED 
(
	CODIGO ASC,
	COD_PEDIDO ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [PARPED]  WITH NOCHECK ADD  CONSTRAINT [FK_PED_PARC] FOREIGN KEY([COD_PEDIDO])
REFERENCES [PEDIDO] ([CODIGO])
NOT FOR REPLICATION 
GO

ALTER TABLE [PARPED] CHECK CONSTRAINT [FK_PED_PARC]
GO


